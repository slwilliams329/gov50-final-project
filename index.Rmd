---
title: "Gov 50 Final Project"
author: "Samantha Williams"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---


```{r, include = FALSE}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(readxl) 

```

```{r}
data <- read_excel("~/Desktop/judicial_review_of_congress_database_1789-2022 (2) (1).xlsx") 
data
```


```{r,include = FALSE}

preCaro <- data |>
  filter(DECADE <= 1930) |>
  group_by(AREA1) |>
  summarize(n = n()) |>
  mutate(prop = (n/sum(n))) 

PreCarolene <- preCaro |>
  mutate(
    PrimaryIssue = case_when(
      AREA1 == 1 ~ "Due Process",
      AREA1 == 2 ~ "Substantive Rights",
      AREA1 == 3 ~ "Equality",
      AREA1 == 4 ~ "Economic",
      AREA1 == 5 ~ "Federalism",
      AREA1 == 6 ~ "Separation of Powers")) |>
  ggplot(mapping = aes(x=PrimaryIssue, y=prop, fill = PrimaryIssue)) +
  geom_col() +
  coord_flip() +
  labs(
    x = "Primary Constitutional Issue",
    y = "Proportion of Cases Presented to Supreme Court",
    title = "Cases Pre-Carolene (1760s-1930s)")
         
```

```{r}
PreCarolene

```


```{r,include = FALSE}
postCaro <- data |>
  filter(DECADE >= 1940) |>
  group_by(AREA1) |>
  summarize(n = n()) |>
  mutate(prop = (n/sum(n))) 

PostCarolene <- postCaro |>
  mutate(
    PrimaryIssue = case_when(
      AREA1 == 1 ~ "Due Process",
      AREA1 == 2 ~ "Substantive Rights",
      AREA1 == 3 ~ "Equality",
      AREA1 == 4 ~ "Economic",
      AREA1 == 5 ~ "Federalism",
      AREA1 == 6 ~ "Separation of Powers")) |>
  ggplot(mapping = aes(x=PrimaryIssue, y=prop, fill = PrimaryIssue)) +
  geom_col() +
  coord_flip() +
  labs(
    x = "Primary Constitutional Issue",
    y = "Proportion of Cases Presented to Supreme Court",
    title = "Cases Post-Carolene (1940s-2010s)")
```


```{r}
PostCarolene

```
```{r}
caro <- preCaro |>
  left_join(postCaro, by = "AREA1") |>
  mutate(PrimaryIssue = c("Due Process","Substantive Rights","Equality","Economic","Federalism","Separation of Powers")) 

caroTable <- caro |>
  mutate(ATE = `prop.y` - `prop.x`) |>
  select(-n.x) |>
  select (-n.y) |>
  select(-AREA1) |>
  relocate(PrimaryIssue, .before = prop.x) 

knitr::kable(carotable, col.names = c("Primary Issue", "Proportion of Cases Presented, Pre-Carolene","Proportion of Cases Presented, Post-Carolene", "Difference in Proportions"))

```



